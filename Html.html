<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Nombre de pompes ‚Äî Pour L√©o</title>
<style>
  /* ===== Variables & Reset ===== */
  :root{
    --bg1: #0f172a;
    --accent: #7c5cff;
    --accent-2: #00e0c6;
    --card: rgba(255,255,255,0.06);
    --glass: rgba(255,255,255,0.04);
    --text: #e6eef8;
    --muted: rgba(230,238,248,0.6);
    --shadow: 0 10px 30px rgba(2,6,23,0.6);
    --radius: 16px;
  }
  *{box-sizing:border-box;margin:0;padding:0}
  html,body{height:100%}
  body{
    font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    color:var(--text);
    background:linear-gradient(120deg,#071029 0%, #081124 40%, #0b1220 100%);
    overflow:hidden;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
  }

  /* ===== Dynamic gradient shapes behind content ===== */
  .bg {
    position:fixed; inset:0; z-index:0; pointer-events:none;
    background:
      radial-gradient(600px 300px at 10% 10%, rgba(124,92,255,0.12), transparent 10%),
      radial-gradient(500px 250px at 85% 85%, rgba(0,224,198,0.08), transparent 10%);
    animation: bgShift 12s ease-in-out infinite alternate;
    mix-blend-mode:screen;
    filter:blur(18px) saturate(1.1);
  }
  @keyframes bgShift{
    0%{transform:translate3d(0,0,0) scale(1)}
    100%{transform:translate3d(-30px,20px,0) scale(1.06)}
  }

  /* ===== Simple particle layer ===== */
  canvas#particles{
    position:fixed; inset:0; z-index:0; pointer-events:none; opacity:0.7;
    mix-blend-mode: screen;
  }

  /* ===== Layout ===== */
  .wrap{
    min-height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:48px 24px;
    position:relative;
    z-index:1;
  }

  .card{
    width:100%;
    max-width:980px;
    background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
    border-radius:var(--radius);
    padding:32px;
    box-shadow:var(--shadow);
    border:1px solid rgba(255,255,255,0.04);
    display:grid;
    grid-template-columns: 1fr 380px;
    gap:28px;
    align-items:center;
    backdrop-filter: blur(8px) saturate(1.05);
  }

  /* Responsive single column */
  @media (max-width:880px){
    .card{grid-template-columns:1fr; padding:20px}
  }

  /* ===== Left panel (info / graph) ===== */
  .left{
    padding:18px;
  }
  .title{
    display:flex; gap:14px; align-items:center; margin-bottom:12px;
  }
  .logo {
    width:56px; height:56px; border-radius:12px;
    background:linear-gradient(135deg,var(--accent),var(--accent-2));
    display:flex;align-items:center;justify-content:center;font-weight:700;color:white;
    box-shadow: 0 10px 30px rgba(124,92,255,0.12), inset 0 -6px 18px rgba(255,255,255,0.06);
    font-size:18px;
  }
  h1{font-size:20px; letter-spacing:-0.2px}
  p.lead{color:var(--muted); margin-top:6px; font-size:14px}

  .progress-wrap{
    margin-top:18px;
  }
  .progress{
    height:14px;
    border-radius:10px;
    background:linear-gradient(90deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
    overflow:hidden;
    border:1px solid rgba(255,255,255,0.02);
  }
  .progress > i{
    display:block;
    height:100%;
    width:0%;
    background: linear-gradient(90deg, var(--accent), var(--accent-2));
    box-shadow: 0 4px 18px rgba(124,92,255,0.24);
    transition:width 560ms cubic-bezier(.2,.9,.28,1);
  }
  .progress-meta{display:flex; justify-content:space-between; margin-top:8px; font-size:13px; color:var(--muted)}

  /* ===== Right panel (counter) ===== */
  .right{
    padding:20px;
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border-radius:12px;
    display:flex; flex-direction:column; align-items:center; gap:18px;
  }

  .counter-circle{
    width:200px; height:200px; border-radius:50%;
    display:flex; align-items:center; justify-content:center; flex-direction:column;
    background: radial-gradient(circle at 30% 25%, rgba(255,255,255,0.03), transparent 20%),
                linear-gradient(135deg, rgba(124,92,255,0.12), rgba(0,224,198,0.08));
    border:1px solid rgba(255,255,255,0.06);
    box-shadow: 0 12px 40px rgba(3,8,23,0.6);
    position:relative;
    transform:translateZ(0);
  }

  .count{
    font-size:48px; font-weight:800; letter-spacing:-2px;
    color: white;
    text-shadow: 0 6px 30px rgba(0,0,0,0.6);
  }
  .label{font-size:14px;color:var(--muted); margin-top:6px}

  /* Glow ring for milestone */
  .glow-ring{
    position:absolute; inset:-8px; border-radius:50%;
    border: 6px solid rgba(124,92,255,0.12);
    filter:blur(14px); opacity:0; transform:scale(0.96);
    transition:all 420ms cubic-bezier(.2,.9,.28,1);
    pointer-events:none;
  }
  .glow-ring.active{opacity:1; transform:scale(1.02); border-color: rgba(124,92,255,0.35);}

  /* Buttons */
  .controls{display:flex; gap:12px; flex-wrap:wrap; justify-content:center}
  button.btn{
    border:0; padding:12px 18px; border-radius:999px; cursor:pointer;
    font-weight:700; color:#071029; background:linear-gradient(90deg,var(--accent),var(--accent-2));
    box-shadow: 0 8px 20px rgba(124,92,255,0.16);
    transition:transform .12s ease, box-shadow .12s ease, opacity .12s;
  }
  button.btn.secondary{
    background:transparent; color:var(--text); border:1px solid rgba(255,255,255,0.06);
    box-shadow:none;
  }
  button.btn:active{ transform:translateY(2px) }

  /* Small utilities */
  .mini{
    display:flex; gap:8px; align-items:center;
    color:var(--muted); font-size:13px;
  }

  /* Confetti canvas overlay (on top of card content) */
  canvas#confetti{
    position:absolute; inset:0; z-index:5; pointer-events:none;
  }

  /* Milestone pulse animation (counter bounce) */
  .count.pulse{
    animation: pop .72s cubic-bezier(.2,.9,.28,1);
  }
  @keyframes pop{
    0%{ transform:scale(1); text-shadow: 0 6px 30px rgba(0,0,0,0.6) }
    30%{ transform:scale(1.16); text-shadow: 0 28px 50px rgba(0,0,0,0.65) }
    100%{ transform:scale(1); text-shadow: 0 6px 30px rgba(0,0,0,0.6) }
  }

  /* little footer / legend */
  .footer{margin-top:8px; font-size:13px; color:var(--muted); text-align:center}
  .big-note{margin-top:6px; font-size:13px; color:var(--muted)}
</style>
</head>
<body>
  <div class="bg" aria-hidden="true"></div>
  <canvas id="particles" aria-hidden="true"></canvas>

  <div class="wrap">
    <div class="card" role="application" aria-labelledby="appTitle">
      <div class="left">
        <div class="title">
          <div class="logo" aria-hidden="true">L√©o</div>
          <div>
            <h1 id="appTitle">Nombre de pompes ‚Äî Pour L√©o</h1>
            <p class="lead">Compteur simple, styl√© et motivant ‚Äî chaque 10 pompes, on c√©l√®bre !</p>
          </div>
        </div>

        <div class="progress-wrap" aria-hidden="true">
          <div class="progress" aria-hidden="true">
            <i id="progressFill" style="width:0%"></i>
          </div>
          <div class="progress-meta">
            <span id="metaCount">0 pompes</span>
            <span id="metaNext">Prochain palier: 10</span>
          </div>
        </div>

        <div style="margin-top:18px;display:flex;gap:14px;flex-wrap:wrap">
          <div style="flex:1;min-width:180px;background:var(--glass);padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.02)">
            <div style="font-size:13px;color:var(--muted)">Objectif quotidien</div>
            <div style="font-weight:700;font-size:18px;margin-top:6px">50 pompes</div>
          </div>

          <div style="flex:1;min-width:180px;background:var(--glass);padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.02)">
            <div style="font-size:13px;color:var(--muted)">Total atteint (session)</div>
            <div id="sessionBest" style="font-weight:700;font-size:18px;margin-top:6px">0</div>
          </div>
        </div>

        <div class="big-note">Astuce : tu peux aussi maintenir le bouton + pour incr√©menter rapidement.</div>
      </div>

      <div class="right" aria-live="polite">
        <div class="counter-circle" aria-hidden="false" aria-label="Compteur de pompes">
          <div class="glow-ring" id="glowRing" aria-hidden="true"></div>
          <div class="count" id="count">0</div>
          <div class="label" id="label">pompes</div>
        </div>

        <div class="controls" role="group" aria-label="Contr√¥les du compteur">
          <button class="btn" id="addBtn">+1</button>
          <button class="btn secondary" id="add5Btn">+5</button>
          <button class="btn secondary" id="undoBtn">‚Üê annuler</button>
          <button class="btn secondary" id="resetBtn">Reset</button>
        </div>

        <div class="mini">
          <div style="display:flex;gap:8px;align-items:center">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M5 12h14M12 5v14" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>
            <span id="sessionInfo">Session en cours</span>
          </div>
        </div>

        <canvas id="confetti" aria-hidden="true"></canvas>
        <div class="footer">Made with üí™ ‚Äî garde la forme, L√©o !</div>
      </div>
    </div>
  </div>

<script>
/* ===========================
   Core counter + UI behavior
   =========================== */

const countEl = document.getElementById('count');
const progressFill = document.getElementById('progressFill');
const metaCount = document.getElementById('metaCount');
const metaNext = document.getElementById('metaNext');
const addBtn = document.getElementById('addBtn');
const add5Btn = document.getElementById('add5Btn');
const undoBtn = document.getElementById('undoBtn');
const resetBtn = document.getElementById('resetBtn');
const glowRing = document.getElementById('glowRing');
const sessionBest = document.getElementById('sessionBest');

let count = 0;
let history = [];
let sessionMax = 0;
const milestone = 10; // every 10 push-ups

function updateUI(animate=false) {
  countEl.textContent = count;
  metaCount.textContent = count + ' pompes';
  const next = Math.ceil((count+1)/milestone)*milestone;
  metaNext.textContent = 'Prochain palier: ' + next;
  const percent = (count % milestone) / milestone * 100;
  progressFill.style.width = percent + '%';
  sessionBest.textContent = sessionMax;

  if (animate) {
    // small pulse
    countEl.classList.remove('pulse');
    // trigger reflow to restart animation
    void countEl.offsetWidth;
    countEl.classList.add('pulse');
  }
}

// milestone celebration
function celebrate() {
  // glow ring
  glowRing.classList.add('active');
  setTimeout(()=>glowRing.classList.remove('active'), 900);

  // big pulse
  updateUI(true);

  // confetti burst
  fireConfetti();

  // playful audio tone (WebAudio)
  try {
    const ctx = new (window.AudioContext || window.webkitAudioContext)();
    const o = ctx.createOscillator();
    const g = ctx.createGain();
    o.type = 'sine';
    o.frequency.setValueAtTime(440 + Math.random()*220, ctx.currentTime);
    g.gain.setValueAtTime(0.0001, ctx.currentTime);
    g.gain.exponentialRampToValueAtTime(0.08, ctx.currentTime + 0.02);
    g.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime + 0.45);
    o.connect(g); g.connect(ctx.destination);
    o.start();
    o.stop(ctx.currentTime + 0.5);
  } catch(e){ /* ignore on Safari without user gesture */ }
}

function add(n=1) {
  history.push(count);
  count += n;
  if (count > sessionMax) sessionMax = count;
  updateUI(true);
  if (count % milestone === 0) {
    // small delay for visual sync
    setTimeout(celebrate, 120);
  }
}
function undo() {
  if (history.length) {
    count = history.pop();
    updateUI(true);
  }
}
function resetAll() {
  history = [];
  count = 0;
  sessionMax = 0;
  updateUI(true);
}

// buttons behavior: click, long-press for +auto
let autoInc = null;
function startAutoIncrement(step){
  if (autoInc) return;
  add(step);
  autoInc = setInterval(()=>add(step), 220);
}
function stopAutoIncrement(){
  if (autoInc) { clearInterval(autoInc); autoInc=null; }
}

addBtn.addEventListener('mousedown', ()=>startAutoIncrement(1));
addBtn.addEventListener('touchstart', ()=>startAutoIncrement(1), {passive:true});
addBtn.addEventListener('mouseup', stopAutoIncrement);
addBtn.addEventListener('mouseleave', stopAutoIncrement);
addBtn.addEventListener('touchend', stopAutoIncrement);
addBtn.addEventListener('click', ()=>{ if(!autoInc) add(1); });

add5Btn.addEventListener('click', ()=>add(5));
undoBtn.addEventListener('click', undo);
resetBtn.addEventListener('click', ()=> {
  if (confirm('R√©initialiser le compteur ?')) resetAll();
});

// keyboard support
window.addEventListener('keydown', (e)=>{
  if (e.key === 'ArrowUp' || e.key === ' ') { e.preventDefault(); add(1); }
  if (e.key === 'Backspace') { e.preventDefault(); undo(); }
  if (e.key === 'r') { e.preventDefault(); resetAll(); }
});

/* ===========================
   Particles background canvas
   =========================== */

const pCanvas = document.getElementById('particles');
const pCtx = pCanvas.getContext('2d');
let pW, pH, particles = [];

function resizeParticles(){
  pW = pCanvas.width = innerWidth;
  pH = pCanvas.height = innerHeight;
  initParticles();
}
window.addEventListener('resize', resizeParticles, {passive:true});

function initParticles(){
  particles = [];
  const count = Math.floor((pW*pH)/70000);
  for (let i=0;i<count;i++){
    particles.push({
      x: Math.random()*pW,
      y: Math.random()*pH,
      r: 2 + Math.random()*6,
      vx: (Math.random()-0.5)*0.25,
      vy: -0.1 - Math.random()*0.4,
      alpha: 0.06 + Math.random()*0.12
    });
  }
}
function drawParticles(){
  pCtx.clearRect(0,0,pW,pH);
  for (const p of particles){
    p.x += p.vx;
    p.y += p.vy;
    if (p.y < -10) { p.y = pH + 10; p.x = Math.random()*pW; }
    if (p.x < -20) p.x = pW + 20;
    if (p.x > pW + 20) p.x = -20;
    pCtx.beginPath();
    pCtx.fillStyle = `rgba(124,92,255,${p.alpha})`;
    pCtx.ellipse(p.x, p.y, p.r, p.r*0.6, Math.PI/6, 0, Math.PI*2);
    pCtx.fill();
  }
  requestAnimationFrame(drawParticles);
}
resizeParticles();

/* ===========================
   Confetti simple engine
   =========================== */

const confettiCanvas = document.getElementById('confetti');
const cCtx = confettiCanvas.getContext('2d');
let cW, cH, confs = [];
function resizeConfetti(){
  cW = confettiCanvas.width = innerWidth;
  cH = confettiCanvas.height = innerHeight;
}
window.addEventListener('resize', resizeConfetti, {passive:true});
resizeConfetti();

function fireConfetti(){
  const total = 60 + Math.floor(Math.random()*40);
  for (let i=0;i<total;i++){
    confs.push({
      x: cW/2 + (Math.random()-0.5)*220,
      y: cH/2 + (Math.random()-0.5)*80,
      vx: (Math.random()-0.5)*6,
      vy: -6 - Math.random()*6,
      ang: Math.random()*Math.PI*2,
      va: (Math.random()-0.5)*0.2,
      size: 6 + Math.random()*8,
      color: i%2===0 ? '#7c5cff' : '#00e0c6',
      life: 0
    });
  }
  if (!confettiLoopActive) runConfetti();
}

let confettiLoopActive = false;
function runConfetti(){
  confettiLoopActive = true;
  function frame(){
    cCtx.clearRect(0,0,cW,cH);
    for (let i = confs.length-1; i>=0; i--){
      const p = confs[i];
      p.vy += 0.22; // gravity
      p.x += p.vx;
      p.y += p.vy;
      p.ang += p.va;
      p.life++;
      // draw as rotated rectangle
      cCtx.save();
      cCtx.translate(p.x, p.y);
      cCtx.rotate(p.ang);
      cCtx.fillStyle = p.color;
      cCtx.fillRect(-p.size/2, -p.size/2, p.size, p.size*0.6);
      cCtx.restore();

      if (p.y > cH + 60 || p.life > 240) confs.splice(i,1);
    }
    if (confs.length>0) requestAnimationFrame(frame);
    else confettiLoopActive = false;
  }
  requestAnimationFrame(frame);
}

/* Start particle loop */
requestAnimationFrame(drawParticles);

/* Initialize UI */
updateUI();

/* Small accessibility: announce milestone for screen readers */
const liveRegion = document.createElement('div');
liveRegion.setAttribute('aria-live', 'polite');
liveRegion.setAttribute('aria-atomic','true');
liveRegion.style.position='absolute';
liveRegion.style.left='-9999px';
document.body.appendChild(liveRegion);
const originalCelebrate = celebrate;
celebrate = function(){
  liveRegion.textContent = 'Bravo ‚Äî palier de ' + count + ' pompes atteint !';
  originalCelebrate();
}
</script>
</body>
</html>